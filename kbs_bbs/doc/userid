�û�hash���

--------------------------------------------------------------------------------

  firebird BBSϵͳ��ѯ�û�һֱʹ�õ��Ǵ�ͷ��β���������û�������ģʽ
�������û�������ڴ��û�����������Ǽ���Ŀ�����Ϊ�˽��������⣬
������ʹ��hash�������û�id�������ӿ�����ٶȡ���صĳ�����libBBS/ucache.c
��libBBS/utmp.c��ʵ�֡�
  ����������Һ�ttiny@SMTH��ͬ��ƣ���ttiny@SMTH��ɡ�
  �Ҳ��õ�������̽����ɢ�е�hash����֮���Բ��ö���̽����ɢ�У��ǿ��ǵ�
�����ǵ�hash_size>2-3����max_user��ʱ�����ѡ��ǡ����hash������hash
�������ʿ���<2�����ж���̽����ɢ�о�û�б�Ҫ�ˡ���ʱ��ʱ�临�Ӷ���O(1)
����ô���hash_size�Ŀռ临�Ӷ��������㣺
  ���Ե���ɢ����Ҫ����hash_size��ͷ��㣬ÿ���û������Ҫ����һ��˫������
��Ҫ������ָ�롣
         hash_head         uidshm
            0  --------->   0 --
            1\              1  |
            2 -\-------->   2  |
                            4<-
           ...             ...
           ...             max_user
           ...
           ...
         hash_size

  hash_size * sizeof(hash_head)+max_user*2*sizeof(pointer)
= 5 * max_user * sizeof(pointer)

  ����SMTH��15���û���hash�Ŀռ�ռ����3M��

  ֮���Ҫ���hash�����ˡ��ҿ��ǵ�namecompleteҲ��Ҫ����uid����������ǰ��
namecomplete��ʽ��������⣺����һ���Ӱ����е�IDȫ���������Ļ����������û�
������һ���̶ȵ�ʱ��namecomplete����ռ�úܴ���ڴ��CPUʱ�䡣������������
һ��Ҫ��namecomplete����Ҫ2����ĸ��ͷ��������ѯ��֮��ֻҪhash�����������
���ԣ���ͬ2����ĸ��ͷ��ID���ǵ�hash value��һ��С��Χ֮�ڣ�������namecomplete
��ʱ�򣬾�ֻ��Ҫ���������Χ�ڵ�user id��
  ��һ��Ҫ����������ʵ�Ҫ���ˡ�id����ĸ�ֲ��Ǻܲ����ȵģ�Ϊ��ttiny����һ��
perl�ű�������SMTH��ID��ĸ��ͷ�ֲ�����ǰ4����ĸ���ݷֲ�����һ����������
������hashֵ��ǰHASHBTABLE_SIZE����ʣ����ĸ����Ϣ����ԶС��ǰ4����ĸ�����
ʣ�µ�HASHBTABLE_SIZE�ռ䡣ǰ�ĸ���ĸ�ı������������ģ�����ǰ������ĸ��ͷ
ID��С��ƽ��ֵ��ʱ����ô��ռ���������һ�����������������ĸ��ͷ��ID
������ɢ��3����ĸ��ͷ�ı�����ǰ������ĸռ��һ�����ͬ�����3����ĸ��ͷ��
ID���Ƕ�Ļ����Ǿ���չ��4����ĸռ��һ������.
  hash value = (ǰ�ĸ���ĸ���)*UCACHE_HASHBSIZE+
                ������ĸ����ֵ%UCACHE_HASHBSIZE;
  ������ĸ��������
  len=strlen(userid)-4;
  ÿ����ĸvalue= id[pos]*(len-pos) posΪ�ں�����ĸ��˳��

  ���һ��Ҫ��ܼ򵥣����ǿյ�user idӦ��ֵΪ0����new�û���ʱ��ֱ�Ӵ�hash[0]
�����ã�����Ҫ��������user list....
  ��󾭹����㣬���ǵ�hash������������1.6.

